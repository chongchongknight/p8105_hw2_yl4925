p8105\_hw2\_yl4925
================
Yiming Li
10/3/2021

## Problem 1

Load trash wheel as required

``` r
trash_wheel_df = readxl::read_excel(
  "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
  sheet = "Mr. Trash Wheel",
  range = "A2:N535") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  filter(dumpster != "Grand Total") %>% 
  mutate(sports_balls = round(sports_balls))
trashrow = nrow(trash_wheel_df)
trashcol = ncol(trash_wheel_df)
```

Read and clean precipitation data for 2018 and 2019. For each, omit rows
without precipitation data and add a variable for year. Next, combine
precipitation dataset and convert month to a character variable

``` r
pre2019 = readxl::read_excel(
  "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
  sheet = "2019 Precipitation",
  range = "A2:B14"
) %>% 
  janitor::clean_names() %>% 
  drop_na(total) %>% 
  mutate(year = 2019) %>% 
  relocate(year)

pre2018 = readxl::read_excel(
  "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
  sheet = "2018 Precipitation",
  range = "A2:B14"
) %>% 
  janitor::clean_names() %>% 
  drop_na(total) %>% 
  mutate(year = 2018) %>% 
  relocate(year)
pre2019row = nrow(pre2019)
pre2019col = ncol(pre2019)
pre2018row = nrow(pre2018)
pre2018col = ncol(pre2018)
```

``` r
##month.name is a vector, not function
bind_rows(pre2018, pre2019) %>% 
  mutate(month = month.name[month])
```

    ## # A tibble: 24 × 3
    ##     year month     total
    ##    <dbl> <chr>     <dbl>
    ##  1  2018 January    0.94
    ##  2  2018 February   4.8 
    ##  3  2018 March      2.69
    ##  4  2018 April      4.69
    ##  5  2018 May        9.27
    ##  6  2018 June       4.77
    ##  7  2018 July      10.2 
    ##  8  2018 August     6.45
    ##  9  2018 September 10.5 
    ## 10  2018 October    2.12
    ## # … with 14 more rows

``` r
sum_2018 = sum(pull(pre2018, total))
ball_2019 = filter(trash_wheel_df, year == 2019)
median_2019 = median(pull(ball_2019, sports_balls))
```

Trash Wheel size is (453, 14). When we load Trash Wheel data, we find
that it includes dumpster labels, date variable(month, year, date) and
totally 10 different categories of trash(Weight\_tons,
volume\_cubic\_yards, plastic\_bottles, polystyrene, cigarette\_butts,
glass\_bottles, grocery\_bags, chip\_bags, sports\_bags,
homes\_powered). Weight\_tons ranges from 0.78 to 5.62 with mean
3.2002208, volume\_cubic\_yards ranges from 7 to 20 with mean
15.4128035, plastic\_bottles ranges from 210 to 5960 with mean
1898.9293598, polystyrene ranges from 210 to 6540 with mean
1920.9205298. (other types of trash are omitted)

The size for 2018 precipitation and 2019 precipitation both are (12, 3).
The total precipitation in 2018 is 70.33, the median number of sports
balls in a dumpster in 2019 is 9.

## Problem 2

Load pols\_month as required, add president variable to show party of
president.

``` r
pols_month = read_csv("./data/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(month = month.name[as.integer(month)],
         president = if_else(prez_gop == 1, "republic", "democratic")) %>% 
  select(-day, -prez_gop, -prez_dem)
```

Load snp data and rearrange data through 2-digit year

``` r
snp_raw = read_csv("./data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("month", "day", "year"), sep = "/") %>% 
  relocate(year, month) %>% 
  mutate(month = as.integer(month)) %>% 
  arrange(year, month) %>% 
  mutate(month = month.name[month]) %>%
  select(-"day")

snp_after_2000 = filter(snp_raw, year <= 20) %>% 
  mutate(year = as.character(as.numeric(year) + 2000))
snp_before_2000 = filter(snp_raw, year >= 20) %>% 
  mutate(year = as.character(as.numeric(year) + 1900))
snp = bind_rows(snp_before_2000, snp_after_2000) 
```

Load unemployment data and switch it to longer version.

``` r
unemployment = read_csv("./data/fivethirtyeight_datasets/unemployment.csv") %>% 
  pivot_longer(
    Jan:Dec, 
    names_to = "month",
    values_to = "unemployment"
  ) %>% 
  mutate(month = month.name[match(month,month.abb)]) %>% 
  rename(year = Year) %>% 
  mutate(year = as.character(year))
```

Join the datasets by merging snp into pols, and merging unemployment
into the result.

``` r
pols_snp = left_join(pols_month, snp) 
pols_snp_unemployment = left_join(pols_snp, unemployment)
```

pols\_month is dataframe for number of national politicians, size is
(822, 9). It contains number of democratic governors, senators,
representatives and presidents, number of republic governors, senators,
representatives and presidents. And it contains date from Jan 1947 -
June 2015.(variables contain year, month, gov\_gop, sen\_gop, rep\_gop,
gov\_dem, sen\_dem, rep\_dem)

snp is dataframe for Standard & Poor’s stock market index, size is (787,
3). It contains the close index for S&P and date from Jan 1950 to July
2015.(variables contain year, month, close)

unemployment is dataframe for unemployment, size is (816, 3). It
contains the percentage of unemployment and date from Jan 1948 to June
2015.(variables contain year, month, unemployment)

pols\_snp\_unemployment join these three datasets, so it includes all
variables above. Its dimension is (822, 11). Its date is from Jan 1947
to June 2015(same to pols\_month)

## Problem 3

Load and tidy the data. (notice that ethnicity and name in 2012 have
same problems )

``` r
## 2012是bug的一年，名字和缩写都不对
pop_baby_name = read_csv("./data/Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  mutate(ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER",
                            "BLACK NON HISP" = "BLACK NON HISPANIC",
                            "WHITE NON HISP" = "WHITE NON HISPANIC"),
         childs_first_name = str_to_sentence(childs_first_name),
         gender = str_to_sentence(gender),
         ethnicity = str_to_sentence(ethnicity))
```

delete duplicated row based on year, gender, ethnicity and first name.

``` r
duplictaed_ones = pop_baby_name[duplicated(pop_baby_name[,1:4]),]
distinct_pop_name = pop_baby_name[!duplicated(pop_baby_name[,1:4]),]
```

Female Olivia rank in different ethnicity among years.

``` r
Olivia_female_rank = filter(distinct_pop_name, gender == "Female" & childs_first_name == "Olivia") %>% 
  select(-gender, -childs_first_name, -count) %>% 
  pivot_wider(
    names_from = year_of_birth,
    values_from = rank
  )
```

Most popular male name in different ethnicity among years.

``` r
most_popular_male_name = filter(distinct_pop_name, gender == "Male" & rank == 1) %>% 
  select(-gender, -rank, -count) %>% 
  pivot_wider(
    names_from = year_of_birth,
    values_from = childs_first_name
  )
```

produce a scatter plot showing the number of children with a name
against the rank in popularity of that name for male white non hispanic
baby in 2016.

``` r
male_nonhisp_2016 = filter(distinct_pop_name, gender == "Male", 
                           ethnicity == "White non hispanic", 
                           year_of_birth == 2016)
##library(ggrepel)
ggplot(male_nonhisp_2016, aes(x = rank, y = count)) + 
  labs(
    title = "2016 white non-hispanic male children's name and rank", 
    x = "rank",
    y = "number of children",
  ) +
  geom_point() 
```

![](p8105_hw2_yl4925_files/figure-gfm/unnamed-chunk-15-1.png)<!-- -->

``` r
##+ geom_text_repel(aes(x = rank, y = count, label = childs_first_name))
```
